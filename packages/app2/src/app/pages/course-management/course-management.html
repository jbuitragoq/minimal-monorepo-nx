<div class="course-management-container">
    <div class="page-header">
        <h2>üìö Gesti√≥n de Cursos</h2>
        <p>Administra los cursos disponibles en la plataforma</p>
    </div>

    <!-- Formulario para crear/editar curso -->
    <div class="course-form" [class.editing]="editingCourse">
        <h3>{{ editingCourse ? 'Editar Curso' : 'Crear Nuevo Curso' }}</h3>
        <form (ngSubmit)="saveCourse()">
            <div class="form-row">
                <div class="form-group">
                    <label for="title">T√≠tulo del Curso:</label>
                    <input type="text" id="title" [(ngModel)]="courseForm.title" name="title" required
                        placeholder="Ej: Introducci√≥n a Angular"
                        [class.error]="courseForm.title.length > 0 && !courseForm.title.trim()">>
                </div>
                <div class="form-group">
                    <label for="teacher">Profesor:</label>
                    <input type="text" id="teacher" [(ngModel)]="courseForm.teacher" name="teacher" required
                        placeholder="Ej: Juan P√©rez"
                        [class.error]="courseForm.teacher.length > 0 && !courseForm.teacher.trim()">
                </div>
            </div>
            <div class="form-group">
                <label for="description">Descripci√≥n:</label>
                <textarea id="description" [(ngModel)]="courseForm.description" name="description" required
                    placeholder="Describe el contenido y objetivos del curso" rows="3"
                    [class.error]="courseForm.description.length > 0 && !courseForm.description.trim()">
        </textarea>
            </div>
            <div class="form-actions">
                <lib-button type="submit" variant="success" [disabled]="isSubmitting || !isFormValid()">
                    {{ isSubmitting ? 'Guardando...' : (editingCourse ? 'Actualizar' : 'Crear') }}
                </lib-button>
                @if (editingCourse) {
                <lib-button type="button" variant="secondary" (click)="cancelEdit()">
                    Cancelar
                </lib-button>
                }
            </div>
        </form>
    </div>

    <!-- Vista de cards de cursos -->
    <div class="courses-preview">
        <h3>Vista Previa de Cursos</h3>
        @if (!loading && !error && courses.length > 0) {
        <div class="courses-grid">
            @for (course of courses; track course.id) {
            <lib-course-card [course]="course" [showActions]="false">
                <lib-button variant="primary" (click)="editCourse(course)">
                    Editar
                </lib-button>
                <lib-button variant="danger" (click)="deleteCourse(course)">
                    Eliminar
                </lib-button>
            </lib-course-card>
            }
        </div>
        }
    </div>

    <!-- Tabla de cursos -->
    <div class="courses-table">
        @if (!loading && !error) {
        <lib-table [data]="courses" [columns]="tableColumns" [actions]="tableActions"
            noDataMessage="No hay cursos creados a√∫n. ¬°Crea el primer curso!">
        </lib-table>
        }

        @if (loading) {
        <div class="loading">
            <p>Cargando cursos...</p>
        </div>
        }

        @if (error) {
        <div class="error">
            <p>‚ùå Error: {{ error }}</p>
            <lib-button (click)="loadCourses()">Reintentar</lib-button>
        </div>
        }
    </div>
</div>